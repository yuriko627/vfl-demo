#!/usr/bin/env fish

echo "Start masking a model on client3"

# Send transaction to erifing the proof for a correct training,
# and if this verification passees, register ECDH public key
echo "Verify proof and register ECDH public key on chain"
cast send 0x8A791620dd6260079BF849Dc5567aDC3F2FdC318 \
  "registerPublicKey(bytes,address,bytes32,bytes32,bytes32[])" \
  0x00b7798a783b3834653ed95ce1477296423591e4d35f38d075ed3576edf74b41301a5dedf06a388bc7831e61b27ac319faa11f49e29a810e1d4f4c24f055b6ba13e39a8489daf5e288b60a469569eb4c8bfa58c16ab284fe3de396becd2d3f3226409143064a51691ece60fe74fbf38e363a9b2ed64b45b012ca23b1024a549f0233a7f188f1466ab7628b1a29eebc3907b27918c941e09e3c9f7b5bdc7737d328371320347acb0e30e17645f73df900797e2d7b544cc72a4b4827a2321fb4f32ea48d071f5f972c8a5c27ecec4798e5c3d38ffab1cf2dfedb93c5d845baa5bf202b5e3d6730a96a1ab12fd847cd05a345bea25d7b88f2bcef673a8a2d048c4d2ff9b4e8f1e6067c9768dd3a5e16ffdb330ba26c9fad069f4b79ab1bdd9169c209223f37246d3ae349ffaaa7a014784e2f7a8f7f84b82981e173769daef36ec80c1ddd29b408f6cee065c4962dd13d8240b8b7a4c7c0265705415d2d808a63f82fe4815e37feaeeeae09c2c7a7a801909d25c6527d16d48de629a5b82341724002b63b89829b80e01717f99c1723267861b42c67de6ac4b5dd6b0f1cb564b67c1c59df0c7498b2730d7ed1114f367456282317473738652b40058620065784ea28982b03b06003d0f681b063fa70b132010725fd7ab02fcce4210cbbd67ca6530655f67ba78c176f75c5defa324a069910e5442aa4a2755ecc93dbad21f9e213208203dbfea61fc3ffe058cba4264d9a19362e6fc05988033f7a855e1a932b8828fc49c03fddb97e2d8e865008239381b1b76f575dd2957b617d9c2748d249b011ed16dfc350251053ae3d8fd44dbfee05e74c7fb577a455e6ae7580d185551e2377f17b1d8221460afaaca9c789b1494a48bc40cc6d139edceb7e45608cb5fc056311153422adcda83f407f9d32ecbd2978e3d2ad4eb008a7139936a35e07c0147df5072ba42ca8ed614d7ad21713f0d944f7af1073732a6915603b19b58bb311a95bd96b91dc219799156263959163ded1ffbedc29e87065f0cca04f4675bc07e92a82adbb8bbf90d4d2d9670170f620c732487b2ee67ff3b4e2c5e36d3824207f7f3897e1e18ceaf669dfa9a6b538ee0f1e78a53696450a613cb8fd7e33c21ffdb371a892e4bd9820d31daf6852c5f57772d781eddfd28d6b281aabd213a00e79965f8edd5b90c89f03531216fc88602fb4076ea40ba82fe64fd3a56e6a1d1fdacaa6a3d8e752d940983b9a8e6f41e7abc56be809c1b61ecac525c9a3f62c1dc7d9639f4d621413234ebf6125c40bb43259bfdc02879bdd72706e100e603420faeb3a16dfb6003b36193821ce06a02c368a0b79e7d15a617f143ad3790beb1781fd64e26901e558d6fcfa0b71a27c599ee042467e136e8c4255e48f66c0f21c5d5f6b06e1869cb029d916f8dfce581f4f7d5871d1b2a4dd7e76f53d6e5ec813c8e51c78b8a7aa83f93a33f09625e5c0101cff61e0039e3451f1f3bba081b40d2438a9255aa4f4daaf2d96bbc47a4377166da7a0da8ea5963a52a77fcfd30d2d17b734a21d6183df46efb4fbdbab29a16365df9ea7a42f66a6a994f36037b025bb9ef0f276f65bb0e2fb1ab6c6ccd763c439f4615f1644f11c579a247222c419200ba6e3e515356b30da0a4206fc698b114e85f7556c2bf2937f01fab4843f0c14ca15d6f2ddbb41fee2b03c78cc52cd6f5ae5328fb146df8789775552bf85080bf44464085659a6a0825a34cd2e8a8a75f5da2aa77f93f0d2d2c97d069be9150bb59e9e91ce5b1a9ad7f1a481b27ead60c322cc3a6218b379dc9c2a20a3670af92ed9d193c9b8fe286a74ac366a2aea364ea5d4efd4f75f80f222602aaf2a2bfffe0ade2c5cac6cbe06793a45d877ca6634b0aa1f39530dd9083e78eba4e91c63d0b4bc8492ebbc779aff425ed528624c35aa453fc67290d4b87244e5a010305e97145f64e7c028340764a6f74b572cb7140c94908cbf574b5b01bc6e54b22c55c142ec7a605e8cd5a70e9f4bad8ee9bdaf018ca85b0c6896a453e4223116284ceb71798fd8fcf17746b897a00fc6a6c449f684c0295979e1eda60bd60d7a244415a006a5519b5618e6628ff471fe63cae4eb7cd7f7a68b2d36f83389e9de04031e72f11dcef80b4222042d2190c2477c90cf22bf4de1021e1c1ba4ba784d04eb2e0cba756fe8dee0123a85376d685c6ad182be6e81b2c044c866e14d940d1ecb57167dbe1dd408f4c76daba1522506779823fdcd5e8171916dae75b82a6b10b349f213c68160edd7886d3f808af9c0f6b84c5478dea30e1612b3ba59582e0c5b300e831d85139c2ec132e06098103ddd2c353e881692245b861d4e767ef2150548db5949c5c2ef0491c911346965637b7ae4fd71f0b736259ad6b981edcc266317c4c68acc984dfdbfedcd5b8c27b2a9a2f5f26ae1db476a7e1b1b87d5921d6c9ef61eacf4550187b0c1d7983e92df76fb33635eaad8d82a961c6e460f67191857c7ea29f5de696677bda3f2858972bf04ef74f1da32d08144838cb8ff502948221cb026570cf4f3f08dcb7b4ac2af4fad7651d2866410d5cb78ece574301c0623457a3bed152def7fe8d69ee6fbc593f2d27887e0761b8ee4e4674c95fe098f5ef6fd5ec277c568ddbca477001bef788d6d2250a09eaba5455c904530e2027f89efbfa0faa13e614a76d02d3c35595c15c549ee45724043e49d088c31610ecde90b1d3acce3c6fd776e573c01fbc030bc5283db276016975fb9c5428ad41b1c48267ad49f264f99a465de4ac7c2270562dfbdc8094deceadad681f8e447276aa741d86e7168d835d15d65598d888dda096cf7b4eb3bc33e55f33eaf3dba090d81b841862773632310f9561bf31eb5a9cb1250681bcedc2fc8d3c059bcfa1a75b11dceb09a63781617392980dc654afb07ec7744f1188cb3dc89bd12594a2cd69726d0447ad0ff9e3499bbfe77e6ac29c4f22bc3d3e367297cbde029271d1fe13711b9be26030a0492afd1c768cedab1765c30eb8ce88ddc5f2fcf52a00b \
  0x2279B7A0a67DB372996a5FaB50D91eAA73d2eBe6 \
  0x061c1436d1c3008037e887c8234dcf7c33c947ad93695b8000fcb4ab70477e3e \
  0x21d66f0e2295ae954494f25889f9319cc1b4df71eff3f46ba9e4631b43fd7c95 \
  [] \
  --rpc-url http://localhost:8545 \
  --private-key 0x4bbbf85ce3377467afe5d46f804f221813b2bb87f24d81f60f1fcdbf7cbf4356

# Fectch 2 neigbor clients' public keys
echo "Fectch 2 neigbor clients' public keys (higher node: Client1, lower node: clinet2)"
cast call 0x8A791620dd6260079BF849Dc5567aDC3F2FdC318 \
  "getNeighborPublicKeys()" \
  --rpc-url http://localhost:8545 \
  --from 0x14dC79964da2C08b23698B3D3cc7Ca32193d9955
#!/usr/bin/env fish

echo "Start masking a model on client1"

# Send transaction to erifing the proof for a correct training,
# and if this verification passees, register ECDH public key
echo "Verify proof and register ECDH public key on chain"
cast send 0x8A791620dd6260079BF849Dc5567aDC3F2FdC318 \
  "registerPublicKey(bytes,address,bytes32,bytes32,bytes32[])" \
  0x2b283e9d890793ebc03635ef1a2ac524040049887a06894be4343b5f921db6af0087c91ca6efbf5c0e0d69ea1d08534a6fab831dfd37922191cf03eed77cf87b1679c56d384bb0ff41c9aa680062cee3ab1b6dc74327960f2502bd1f9846f2a907060bedbc719968c791d9b97fd51dd518d8a4ad01b7864d9ae583e57b2b507d00a94d5e6eba2d05eeaede76294e4aaa623f62be259f8369ceff1337ebbd64431d8b0579c39d07070b568f7709849e22874260071678bff45dc9b8a8f17529c5256b08a92588027641aae57c1fd3b057f7d67cb628a5cd01bdc0280eaa5ca4902dcc4a73f338d9c9913b124952fa6989723417f8bab73332fe1db8a03949f6651ea4fc721578d979ecf4415def7a590d81cd9a3a7a982ed1dca25487b91c6dda179a6ff8fb634836da210f5ef2c8b4a3678c3a6c3dae842457682619b3e3ecaa1444ca34a411cb0f63d5866789763ae1e25ae49019e7e89a68b7fddc3922a7b00e6dae2c2c35884d2aca6febaed1bab52f1da64c2f3d01acea36462367be0ca50931533adb65b4d7e16d6e9c9345ca352d69d767fc9512bd335c7a2e9eae7a79230c067464290ba1b79aa5a76d03823000c1db32e70b933fcbb5b293b5ab39d4277668aae28c1fab44e9174f62ed8f3ffcae349bbbd42ef67b3fa37dd0788ad0241fc349ade3a62ebf0acfda5c086b6f01b14dd66b1b4cd3d8edbe61453df3f91cd2df6ebd12d137ac8237a72084005d7696ea2dab145924547bfdb6fc7f191d2ab22a27edae1549e162b82e05e6692650e875093b2bea557271117876c96d382abb70d5641344bd6d779b35eee66cef7130d05b771e678081dec2261a7eb9a3222ced67d8813e73e66fe0679814e693c429bcd1a9291afa75eb9507b868d2a90de63e7d8db0cb523c2d82aac39b533b60bb572c0e4f05c755e29a39c5bb43fc0893ae712bda5c252198dfa9b4dba4441ea59fe36050220f346c5f437d79a8ac2ea40d610420fda6faf1deadd328784b2f2bf0b9c1a9e350fde203a7bb0e094b17a03e4308acd0f1b1bd9cd79566479bf9302b559b78282b6d7b792bfb98af5624257757b98e4e241cca9ec1a3db74efeac884776a55f8a9ca1aca1286475690004f4f4cbcce106e7d097bdbfadcb3c2b60153d635a76703c41232219c94b73416c482a8a1f7d771bd1ea9a7ea6e92a5e643cefb686132b6742d11a7140596af0059472958b86a9fdcb652fc6ecde47123242d214888a1711f1b2da73ac6665b28abf466c8e74eea86d31d84f2040f12e039385f1e88093b7c75744e40bbb7c00aabd922c0d696db5118a54d8fb0f3419b7a91e20e051a193880060dba77b66824484c632f19faef01cbb6a816070ddb7ffe9ba5620ef9ddebbccbe14b99f9552160b3a155ccfa6ca2e00545f0fb66d492592ff55663ff9dd306a0cdd5ba15dc2ebdcb3f1ea35e575fdb64673095f23b74a1c56e94aa065046b38a090f0b9bcc2bcd68335ead4d800aafb9c3b2a246788106a4da0b9089de724d69fac80835810c54eaf3349a285ebacf954b39d56c7b79c65f54c9ac7d9e8dd72396debc206618fdf09cc992f80ac2a5146c2f624c7e0fd914a441909720be8e965898948a77160849cd9512a7e80bb65336f9525cb45aa84a752c801ce9390215d16eab5fbe156a02affcef990446797e9f0f7faeedaef0ab4af48627e59d66cc938ef3126c17cb1f6e357bff5a156a8cb0bbe33424897d301a6506d6ff20ab1c322d0e14782c1b2e4c53f87981e51640007adb12a060128009aa4afa3a11407595a05728c801fdb36ce8cbdddbdc5acae5667a41893fa4c87b79d37608f6b0473f13eb6a8c1a89b5d1e651cf449b9d9e2ace03681eda49c4962ea0f502c3749d3b71909b1a0db0b1fab83545288e8de4f4ac20880ddd906d88fba5754b9006b2adbddacd341c8d58eaa694cc05b34ca8d414aa3e923e9639b9460835322733bb6f694418901eee75a8df21325b823db6e5c10dc3c91922be88b688e44baa780b0e075f1a9c214f926717ad98b1512ec4f76d7148fff3af4358270993652dbc5aaca57a1ca823b0af255039ff07201fd30919d4ce36ce3bc827978a427eb100aa4b43951eb41a2c3c2c6e0865afe45b9ac26846b95b6409b4e9d5878618a3ef6bd0cb291684210a82a157dfabbf8625752bdbe69896430b86f266dfdc2a2915799cd0c04bff2bc5466c4245a40c7bd2d73262ee6a612ac05221867e9078770cd8443591fd3020bb6f84be7482297fc5c15096bc9324edd77d0f80cedd6825a8e778d0f0bfa119e05a0099f3648018e4e552626aad875e20579a38de2d732110f4aa0ccca45409ffe117a6160b1d307aeac8c52835773e68bf48973671d695222446bd9c6a4a082bcf814e4d34b882929f76713c328ba457fc8d6b7e7914b192009d68313fe001c52131e5bcd75e3b7f81a27b129638653bb58bee81b9bf86d3aaeee2d208af19998422bee669f06aaa5394aa6185ab247105c6ec5deb0746324ffa8c48197f0f1930815b2cb46a636fbc747f82fbda216bfa6963fd6441f3a00a37598d47152a6f4bbbc6eef35b2d328e76d923d6d2be1883ed848922258fa2760b6ce000ef043c7355ca607090635ee8d8e3b14ee2609c9d3240980070b65b9fd46969a63c2d6d89d34ee1da23cb5921f4dedba9bcc5f43efd6c000ccbed11009a81760da810f3cbada9fe418af6c060fa45c267a3bba5feb78e846d7c13911cef6c3fe42024de5bfae64c491bda77e5b62e2a7de7d98ba6ba2ac23ebd7df32ed84709ba9908649dd54168b08305df24bb95113bcecf3d66744d469f6da4734b2d31d3911112d20984b42e5ac61b0b0296ba01640b2e825c47ce2dd49583d0a900b453113212d8c58ed943c62ab2e24bae0149c55065ee3407f72cab77afbe43d919a544e91de56286119e806c39289bc6808c657e5630848075871e9320b6952f1595ab221f262b1511b41d6dbc6c0cf325f5616820e313a6597788a34e40b5359f4bced0 \
  0x0165878A594ca255338adfa4d48449f69242Eb8F \
  0x0bb77a6ad63e739b4eacb2e09d6277c12ab8d8010534e0b62893f3f6bb957051 \
  0x25797203f7a0b24925572e1cd16bf9edfce0051fb9e133774b3c257a872d7d8b \
  [] \
  --rpc-url http://localhost:8545 \
  --private-key 0x2a871d0798f97d79848a013d4936a73bf4cc922c825d33c1cf7073dff6d409c6

# Fectch 2 neigbor clients' public keys
echo "Fectch 2 neigbor clients' public keys (higher node: Client2, lower node: clinet3)"
cast call 0x8A791620dd6260079BF849Dc5567aDC3F2FdC318 \
  "getNeighborPublicKeys()" \
  --rpc-url http://localhost:8545 \
  --from 0xa0Ee7A142d267C1f36714E4a8F75612F20a79720
